<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DL Waitlist Manager</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/waitlist.css?t=1">
  <style>
    /* Mobile viewport height fix for address bar */
    body {
      height: 100vh; /* Fallback for older browsers */
      height: 100dvh; /* Dynamic viewport height (excludes address bar) */
    }
    
    /* For browsers that don't support dvh, use JavaScript fallback */
    @supports not (height: 100dvh) {
      body {
        height: var(--vh, 100vh);
      }
    }
    
    /* Ensure table header stays fixed during scroll */
    #waitlist-container thead {
      position: sticky !important;
      top: 0 !important;
      z-index: 10 !important;
      background-color: rgb(30 41 59) !important; /* bg-slate-800 */
    }
    
    /* Fix for webkit browsers sticky positioning */
    #waitlist-container thead th {
      position: sticky !important;
      top: 0 !important;
      background-color: rgb(30 41 59) !important; /* bg-slate-800 */
    }
  </style>
</head>

<body class="overflow-hidden p-4 sm:p-8 flex flex-col">
  <!-- Dark Modern container -->
  <div class="bg-slate-800 rounded-xl shadow-2xl p-4 sm:p-6 border border-slate-700 flex-1 flex flex-col min-h-0">
    <header class="mb-6 border-b border-slate-600 pb-3">
      <div class="flex items-center justify-between">
        <h1 class="text-2xl sm:text-3xl font-bold text-slate-100 flex items-center">
          <!--
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="w-8 h-8 text-violet-400 mr-3">
            <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
            <circle cx="12" cy="7" r="4" />
            <path d="M2 22h20" />
            <path d="M2 17h20" />
          </svg>
          
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="3" y="3" width="18" height="18" rx="3" stroke="currentColor" stroke-width="2" />

            <line x1="6" y1="7.5" x2="15" y2="7.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            <line x1="6" y1="11.5" x2="12" y2="11.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />

            <circle cx="16.5" cy="16.5" r="4.2" fill="none" stroke="currentColor" stroke-width="2" />
            <path d="M16.5 13.5V16.5H19.2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
          
          &nbsp;
          -->
          Waitlist Manager
        </h1>
        <!-- Scroll to Active Button -->
        <button id="scroll-to-active-btn" onclick="handleScrollToActive()" disabled
          class="action-button px-3 py-2 rounded-lg transition duration-150 bg-slate-700 text-slate-500 cursor-not-allowed border border-slate-600 flex items-center justify-center">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="5" y="3" width="14" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
            <line x1="8" y1="7" x2="16" y2="7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="8" y1="10" x2="16" y2="10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="8" y1="13" x2="16" y2="13" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
            <path d="M12 19L12 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M14.5 16.5L12 19L9.5 16.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
      <!-- <p class="text-slate-400 mt-1">Real-time queue status and customer service management</p> -->
    </header>

    <!-- Waitlist Table -->
    <!-- Outer div maintains shadow and horizontal scroll for narrow screens -->
    <div class="shadow-2xl rounded-lg overflow-x-auto border border-slate-700 flex-1 min-h-0 flex flex-col">
      <!-- Inner container for vertical scrolling with fixed header -->
      <div id="waitlist-container" class="flex-1 overflow-y-auto relative bg-slate-900">
        <table class="min-w-full divide-y divide-slate-700" style="table-layout: fixed;">
          <thead class="bg-slate-800 sticky top-0 z-10 border-b border-slate-700">
            <tr>
              <!-- Reduced padding (px-1 py-1) and centered -->
              <th class="px-1 py-1 text-center text-xs font-semibold text-slate-300 tracking-wider w-[6%]">No.
              </th>
              <!-- Expanded width for Name column (now includes previous Pax column width) -->
              <th class="px-1 py-1 text-left text-xs font-semibold text-slate-300 tracking-wider w-[40%]">Name
              </th>
              <!-- Minimized width for Elapsed Time -->
              <th class="px-1 py-1 text-center text-xs font-semibold text-slate-300 tracking-wider w-[9%]">
                Elapsed</th>
              <!-- Adjusted width for Action column - Hidden on mobile -->
              <th
                class="action-column-header px-1 py-1 text-center text-xs font-semibold text-slate-300 tracking-wider w-[45%]">
                Action</th>
            </tr>
          </thead>
          <tbody id="waitlist-body" class="bg-slate-900 divide-y divide-slate-800">
            <!-- Data will be injected here by JavaScript -->
          </tbody>
        </table>
      </div>
    </div>

    <footer class="mt-6 text-center text-slate-500 text-sm flex-shrink-0">
      <p>&copy; 2025 Waitlist Manager. All rights reserved.</p>
    </footer>
  </div>

  <!-- Message Box for Alerts (replacing alert()) - Dark theme -->
  <div id="message-box" class="fixed inset-0 bg-black bg-opacity-70 hidden items-center justify-center p-4 z-50">
    <div class="bg-slate-800 p-6 rounded-lg shadow-2xl max-w-sm w-full border border-slate-700">
      <h3 class="text-lg font-bold text-slate-100 mb-4">Notification</h3>
      <p id="message-text" class="text-slate-300 mb-6"></p>
      <div class="text-right">
        <button onclick="closeMessageBox()"
          class="px-4 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700 transition duration-150 action-button border-0">
          Close
        </button>
      </div>
    </div>
  </div>
  <script>
    // Mobile viewport height fix - avoid conflicts with waitlist.js
    (function() {
      // Private function to set viewport height
      function updateMobileViewportHeight() {
        const vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
      }
      
      // Set initial viewport height
      updateMobileViewportHeight();
      
      // Update on resize (handles address bar show/hide) - use passive listeners
      window.addEventListener('resize', updateMobileViewportHeight, { passive: true });
      window.addEventListener('orientationchange', () => {
        setTimeout(updateMobileViewportHeight, 100); // Small delay for orientation change
      }, { passive: true });
    })();
  </script>
  <script src="js/toastMsg.js"></script>
  <script src="js/sqlConnector.js"></script>
  <script src="js/waitlist.js?t=5"></script>
  
</body>

</html>