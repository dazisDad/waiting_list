<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DL Waitlist Manager</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/waitlist.css?t=5">
  <style>
    /* Mobile viewport height fix for address bar */
    body {
      height: 100vh; /* Fallback for older browsers */
      height: 100dvh; /* Dynamic viewport height (excludes address bar) */
    }
    
    /* For browsers that don't support dvh, use JavaScript fallback */
    @supports not (height: 100dvh) {
      body {
        height: var(--vh, 100vh);
      }
    }
    
    /* Ensure table header stays fixed during scroll */
    #waitlist-container thead {
      position: sticky !important;
      top: 0 !important;
      z-index: 10 !important;
      background-color: rgb(30 41 59) !important; /* bg-slate-800 */
    }
    
    /* Fix for webkit browsers sticky positioning */
    #waitlist-container thead th {
      position: sticky !important;
      top: 0 !important;
      background-color: rgb(30 41 59) !important; /* bg-slate-800 */
    }
  </style>
</head>

<body class="overflow-hidden p-4 sm:p-8 flex flex-col">
  <!-- Dark Modern container -->
  <div class="bg-slate-800 rounded-xl shadow-2xl p-4 sm:p-6 border border-slate-700 flex-1 flex flex-col min-h-0">
    <!-- Waitlist Table -->
    <!-- Outer div maintains shadow and horizontal scroll for narrow screens -->
    <div class="shadow-2xl rounded-lg overflow-x-auto border border-slate-700 flex-1 min-h-0 flex flex-col">
      <!-- Inner container for vertical scrolling with fixed header -->
      <div id="waitlist-container" class="flex-1 overflow-y-auto relative bg-slate-900">
        <table class="min-w-full divide-y divide-slate-700" style="table-layout: fixed;">
          <thead class="bg-slate-800 sticky top-0 z-10 border-b border-slate-700">
            <tr>
              <!-- Reduced padding (px-1 py-1) and centered -->
              <th class="px-1 py-1 text-center text-xs font-semibold text-slate-300 tracking-wider w-[6%]">No.
              </th>
              <!-- Expanded width for Name column (now includes previous Pax column width) -->
              <th class="px-1 py-1 text-left text-xs font-semibold text-slate-300 tracking-wider w-[40%]">Name
              </th>
              <!-- Minimized width for Elapsed Time -->
              <th class="px-1 py-1 text-center text-xs font-semibold text-slate-300 tracking-wider w-[9%]">
                Elapsed</th>
              <!-- Adjusted width for Action column - Hidden on mobile -->
              <th
                class="action-column-header px-1 py-1 text-center text-xs font-semibold text-slate-300 tracking-wider w-[45%]">
                Action</th>
            </tr>
          </thead>
          <tbody id="waitlist-body" class="bg-slate-900 divide-y divide-slate-800">
            <!-- Data will be injected here by JavaScript -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Footer with Title and Action Buttons -->
    <footer class="mt-4 flex justify-between items-center gap-4 flex-shrink-0">
      <!-- Title with Version -->
      <div class="flex flex-col">
        <div class="text-slate-200 text-base font-semibold leading-tight">Waitlist Manager</div>
        <div id="version-display" class="text-slate-500 text-xs"></div>
      </div>
      
      <!-- Action Buttons -->
      <div class="flex gap-2">
        <!-- Settings Button -->
        <button id="settings-btn" onclick="handleSettings()"
          class="action-button w-12 h-12 rounded-lg transition duration-150 bg-slate-700 text-slate-300 hover:bg-slate-600 border border-slate-600 flex items-center justify-center flex-shrink-0">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="26" height="26" fill="currentColor">
  <path d="M20.2 10.83c.06.38.09.77.09 1.17 0 .4-.03.79-.09 1.17l2.32 1.81c.21.16.27.46.15.7l-2.2 3.8c-.13.23-.41.32-.65.23l-2.73-1.1c-.58.44-1.22.81-1.91 1.09l-.41 2.91c-.04.26-.27.46-.53.46h-4.4c-.27 0-.49-.19-.53-.46l-.41-2.91c-.69-.28-1.33-.65-1.91-1.09l-2.73 1.1c-.24.1-.52 0-.65-.23l-2.2-3.8c-.12-.24-.06-.53.15-.7l2.32-1.81c-.06-.38-.09-.77-.09-1.17 0-.4.03-.79.09-1.17L1.48 9.39c-.21-.16-.27-.46-.15-.7l2.2-3.8c.13-.23.41-.32.65-.23l2.73 1.1c.58-.44 1.22-.81 1.91-1.09l.41-2.91c.04-.26.27-.46.53-.46h4.4c.27 0 .49.19.53.46l.41 2.91c.69.28 1.33.65 1.91 1.09l2.73-1.1c.24-.1.52 0 .65.23l2.2 3.8c.12.24.06.53-.15.7l-2.32 1.81zM12 16c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4z"/>
</svg>
        </button>
      
      <!-- Add Button -->
      <button id="add-btn" onclick="handleAdd()"
        class="action-button w-12 h-12 rounded-lg transition duration-150 bg-slate-700 text-slate-300 hover:bg-slate-600 border border-slate-600 flex items-center justify-center flex-shrink-0">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <line x1="12" y1="5" x2="12" y2="19" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
          <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
        </svg>
      </button>
        
        <!-- Scroll to Active Button -->
      <button id="scroll-to-active-btn" onclick="handleScrollToActive()" disabled
        class="action-button w-12 h-12 rounded-lg transition duration-150 bg-slate-700 text-slate-500 cursor-not-allowed border border-slate-600 flex items-center justify-center flex-shrink-0">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="5" y="3" width="14" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
          <line x1="8" y1="7" x2="16" y2="7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          <line x1="8" y1="10" x2="16" y2="10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          <line x1="8" y1="13" x2="16" y2="13" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
          <path d="M12 19L12 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M14.5 16.5L12 19L9.5 16.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        </button>
      </div>
    </footer>
  </div>

  <!-- Message Box for Alerts (replacing alert()) - Dark theme -->
  <div id="message-box" class="fixed inset-0 bg-black bg-opacity-70 hidden items-center justify-center p-4 z-50">
    <div class="bg-slate-800 p-6 rounded-lg shadow-2xl max-w-sm w-full border border-slate-700">
      <h3 class="text-lg font-bold text-slate-100 mb-4">Notification</h3>
      <p id="message-text" class="text-slate-300 mb-6"></p>
      <div class="text-right">
        <button onclick="closeMessageBox()"
          class="px-4 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700 transition duration-150 action-button border-0">
          Close
        </button>
      </div>
    </div>
  </div>
  <script>
    // Mobile viewport height fix - avoid conflicts with waitlist.js
    (function() {
      // Private function to set viewport height
      function updateMobileViewportHeight() {
        const vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
      }
      
      // Set initial viewport height
      updateMobileViewportHeight();
      
      // Update on resize (handles address bar show/hide) - use passive listeners
      window.addEventListener('resize', updateMobileViewportHeight, { passive: true });
      window.addEventListener('orientationchange', () => {
        setTimeout(updateMobileViewportHeight, 100); // Small delay for orientation change
      }, { passive: true });
    })();
  </script>

  <script src="js/notification.js"></script>
  <script src="js/polling_json.js"></script>
  <script src="httpsRequest/sender.js"></script>
  <script src="js/api_init.js"></script>

  <script src="js/toastMsg.js"></script>
  <script src="js/sqlConnector.js"></script>
  <script src="js/waitlist.js?t=7"></script>
  <script src="js/modal_add.js"></script>
  
</body>

</html>